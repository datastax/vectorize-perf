<html>
<head>
    <link rel="stylesheet" href="/styles.css">
    <script src="/script.js"></script>
</head>
<body>
    <div id="container">
        <div id="vectorize" class="pane"><h1>Vectorize</h1></div>
        <div id="openai" class="pane"><h1>OpenAI</h1></div>
    </div>
    <script async>
        function showWord(word, version, duration) {
            const drop = document.createElement("div");
            drop.classList.add("drop")
            drop.classList.add("word")
            drop.classList.add(version)
            drop.style.left = (version === "vectorize" ? 0 : 50) + Math.random() * 40 + "%";
            drop.style.animationDuration = (duration * 10) + "ms"
            drop.innerText = word
            document.getElementById(version).appendChild(drop)
        }

        const words = window.text.split(" ")

        async function run(words, version) {
            for (word of words) {
                const start = Date.now()
                console.log("api call for ", word)
                const response = await fetch(`/api/${ version }`, {
                    method: "POST",
                    body: JSON.stringify({ word }),
                    headers: { "Content-type": "application/json; charset=UTF-8" }
                })
                const json = await response.json()
                console.log("showing ", json.word)
                const end = Date.now()
                const duration = end - start
                showWord(json.word, version, duration)               
            }
        }

        run(words, "openai")
        run(words, "vectorize")

    </script>
</body>
</html>